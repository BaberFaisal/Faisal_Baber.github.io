---
layout: post
title: "Artist-Genre Relationship Analysis Using SQL"
image: /posts/artist-genre-sql.jpg
tags: [SQL, Data Analysis, Spotify, Music Analytics, Window Functions]
---

## Project Purpose  

The purpose of this project is to analyze the **Spotify dataset** using SQL to uncover insights about tracks, artists, albums, and user interactions.  

We focus on answering practical business and analytical questions — from identifying the most popular tracks and albums, to exploring artist productivity, track characteristics, and engagement patterns.  

The queries showcase SQL capabilities such as **aggregation, filtering, grouping, window functions, subqueries, and CTEs** to extract meaningful information.  

---

## Table of Contents  

- Project Overview  
  - Context  
  - Actions  
  - Results & Discussion  
- Concept Overview  
- Data Overview & Preparation  
- SQL Queries & Explanations  
- Analysing the Results  
- Discussion  

---

## 00. Project Overview  

### Context  
The global music industry relies heavily on **data-driven insights** to understand listener behavior.  
Platforms like Spotify and YouTube collect billions of data points on track streams, likes, views, comments, and engagement.  

Understanding these patterns helps artists, producers, and record labels to:  
- Identify their most successful content.  
- Optimize release strategies.  
- Improve user retention and satisfaction.  

This project demonstrates how SQL can be used to analyze a dataset of Spotify tracks and extract **actionable insights**.  

### Actions  
- Queried track-level data including **streams, views, likes, comments, album info, and track attributes**.  
- Used SQL to filter, aggregate, and summarize the dataset.  
- Applied **window functions** and **CTEs** for advanced analytics.  
- Extracted meaningful patterns such as top tracks, artist productivity, and audio feature distributions.  

### Results & Discussion  
The SQL queries revealed:  
- Several tracks surpassed **1 billion streams**, marking massive global success.  
- Certain artists dominated in terms of **track counts and views**.  
- Danceability, energy, and liveness characteristics varied significantly across albums.  
- Window functions enabled ranking and cumulative metrics, adding depth to the analysis.  

---

## 01. Concept Overview  

- **Relational Databases in Music Analytics**  
  SQL queries allow efficient filtering and summarization of music track datasets.  

- **Aggregations (SUM, COUNT, AVG, MAX, MIN)**  
  Used to calculate totals, averages, and extremes (e.g., top streams, average danceability).  

- **Grouping & Filtering (GROUP BY, HAVING, WHERE)**  
  Enables segmentation by artist, album, and other features.  

- **Window Functions**  
  Provide rankings, cumulative sums, and row-specific insights.  

- **CTEs (Common Table Expressions)**  
  Simplify complex queries by breaking them into smaller steps.  

---

## 02. Data Overview & Preparation  

### Dataset Fields  
- `track` — Track name  
- `artist` — Artist name  
- `album` — Album name  
- `album_type` — Album classification (single, album, compilation)  
- `streams` — Number of Spotify streams  
- `views` — Number of YouTube views  
- `likes` — Likes on YouTube  
- `comments` — User comments  
- `danceability`, `energy`, `liveness` — Audio features  
- `official_video` — Boolean flag for official video  
- `licensed` — Boolean flag for licensing status  
- `most_played_on` — Platform where track is most played  

### Cleaning & Validation  
- Ensured correct datatypes for `streams`, `views`, `likes`, and `comments`.  
- Removed duplicates.  
- Confirmed boolean values (`licensed`, `official_video`) were properly formatted.  

---

## 03. SQL Queries & Explanations  

1. Retrieve the names of all tracks that have more than 1 billion streams.
```sql

SELECT track, artist, streams 
FROM spotify 
WHERE stream > 1000000000;
```
Finds massively popular tracks with over 1B Spotify streams.


2. List all albums along with their respective artists.
```sql
SELECT DISTINCT album,artist
FROM spotify
ORDERED BY 1;
```
Produces a unique list of albums and artists, sorted by album name.

3. Get the total number of comments for tracks where `licensed = TRUE`.
```sql
SELECT SUM(comments) as total_comments
FROM spotify
WHERE licensed = "true";

```
Sums up all comments only for licensed tracks, showing engagement volume.


4. Find all tracks that belong to the album type `single`.
```sql
SELECT *
FROM spotify
WHERE album_type = "single";
```
Retrieves all details for tracks that are released as singles.

5. Count the total number of tracks by each artist.
```sql
SELECT 	artist, COUNT(*) as total_no_songs
FROM spotify
GROUP BY artist
ORDERED BY 2;
```
Shows artist productivity by counting how many tracks each has.

6. Calculate the average danceability of tracks in each album.
```sql
SELECT album, avg(danceability) as avg_danceability
FROM spotify
GROUP BY 1
ORDERED BY 2 DESC;
```
Identifies albums with the most danceable songs.

7. Find the top 5 tracks with the highest energy values.
```sql
SELECT track, MAX(energy)
FROM spotify
GROUP BY 1
ORDERED BY 2 DESC
LIMIT 5;

```
Returns the 5 most energetic songs.


8. List all tracks along with their views and likes where `official_video = TRUE`.
```sql
SELECT track, views, likes 
FROM spotify 
WHERE official_video = TRUE;
```
Lists official music videos and their engagement (views + likes).


9. For each album, calculate the total views of all associated tracks.
```sql
SELECT album, SUM(views) AS total_views 
FROM spotify 
GROUP BY album 
ORDER BY total_views DESC;
```
Ranks albums by total YouTube views across tracks.

10. Retrieve the track names that have been streamed on Spotify more than YouTube.
```sql
SELECT track, artist, stream, views 
FROM spotify 
WHERE most_played_on = 'Spotify' AND stream > views;
```
Filters tracks that are more popular on Spotify than YouTube.

11. Find the top 3 most-viewed tracks for each artist using window functions.
```sql
SELECT artist, track, views
FROM (
    SELECT artist, track, views,
           ROW_NUMBER() OVER (PARTITION BY artist ORDER BY views DESC) AS rn
    FROM spotify
) t
WHERE rn <= 3;
```
Uses ROW_NUMBER() to rank tracks and return top 3 by views per artist.

12. Write a query to find tracks where the liveness score is above the average.
```sql
SELECT track, artist, liveness
FROM spotify
WHERE liveness > (SELECT AVG(liveness) FROM spotify);
```
Finds tracks that feel more “live” than average.


13. **Use a `WITH` clause to calculate the difference between the highest and lowest energy values for tracks in each album.**
```sql
WITH cte
AS
(SELECT 
	album,
	MAX(energy) as highest_energy,
	MIN(energy) as lowest_energery
FROM spotify
GROUP BY 1
)
SELECT 
	album,
	highest_energy - lowest_energery as energy_diff
FROM cte
ORDER BY 2 DESC
```
Calculates energy range (difference between max & min energy) per album.
   
14. Find tracks where the energy-to-liveness ratio is greater than 1.2.
```sql
SELECT track, artist, energy, liveness, 
       (energy / NULLIF(liveness, 0)) AS energy_liveness_ratio
FROM spotify
WHERE (energy / NULLIF(liveness, 0)) > 1.2;
```
Highlights tracks with unusually high energy relative to liveness.


15. Calculate the cumulative sum of likes for tracks ordered by the number of views, using window functions.
```sql
SELECT track, artist, views, likes,
       SUM(likes) OVER (ORDER BY views DESC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_likes
FROM spotify;
```

Uses a cumulative window sum to track how likes accumulate across popularity.

## 04. Analysing the Results  

- Tracks with **billions of streams** reflect global hits.  
- **Singles** often dominate top streams, showing their promotional importance.  
- Some artists are **extremely prolific** with dozens of tracks, while others rely on fewer but more successful releases.  
- **Danceability and energy** vary significantly across albums, hinting at differences in style.  
- **Cumulative analysis** of likes vs views reveals engagement patterns at scale.  

---

## 05. Discussion  

### Strengths  
- Demonstrates a wide variety of **SQL concepts** (aggregation, grouping, window functions, CTEs).  
- Extracts actionable insights about **artist popularity, track success, and album characteristics**.  
- Provides a **portfolio-ready analysis** for SQL-based data exploration.  

### Limitations  
- Based on a **single dataset snapshot**; real-world streaming data changes daily.  
- Does not account for **time-series trends** (e.g., growth of streams over months).  
- Query 7 (`MAX(energy)`) assumes per-track uniqueness — in practice could be simplified.  

### Next Steps  
1. Extend analysis with **time-based trends** (streams per year).  
2. Integrate with **genre-level metadata** for deeper insights.  
3. Apply SQL with **BI tools** (e.g., Tableau, Power BI) for interactive dashboards.  

---








