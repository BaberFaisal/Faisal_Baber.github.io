---
layout: post
title: "Will They Stay or Leave? Predicting Customer Churn with Logistic Regression"
image: /posts/churn-logistic.jpg
tags: [Python, Machine Learning, Logistic Regression, Telecom, Customer Analytics, Data Science]
---

## Project Purpose  

The purpose of this project is to predict **customer churn** using **Logistic Regression**.  
Customer churn — when customers discontinue service or switch providers — is a major challenge in the telecom industry. Since retaining existing customers is often more cost-effective than acquiring new ones, **predicting churn in advance** can help businesses deploy proactive retention strategies.  


## GitHub Repository Link  


The source code for this project can be found at my [GitHub Repository](https://github.com/BaberFaisal/Will-They-Stay-or-Leave-Predicting-Customer-Churn-with-Logistic-Regression.git). 

---

## Table of Contents  

- [00. Project Overview](#00-project-overview)  
  - [Context](#context)  
  - [Actions Taken in the Notebook](#actions-taken-in-the-notebook)  
  - [Results & Discussion (High-Level)](#results--discussion-high-level)  
- [01. Concept Overview](#01-concept-overview)  
- [02. Data Overview & Preparation](#02-data-overview--preparation)  
- [03. Exploratory Data Analysis](#03-exploratory-data-analysis-with-plot-explanations)  
- [04. Modeling Pipeline](#04-modeling-pipeline)  
- [05. Analysing the Results](#05-analysing-the-results)  
- [06. Discussion](#06-discussion)  

---

## 00. Project Overview  

### Context  

Customer churn—defined as the phenomenon where customers discontinue a service or switch to a competitor—remains one of the most critical business challenges for telecom companies. Retaining existing customers is often more cost-effective than acquiring new ones. Therefore, building accurate models to predict churn in advance is a valuable data science application.  

In this project, we develop a **Logistic Regression–based churn prediction model** using a real-world styled telecom dataset. The notebook implements an end-to-end pipeline: **data loading, cleaning, exploration, feature engineering, model training, evaluation, interpretation, and export**.  

The project is structured in stages, closely following an academic workflow:  

1. Understanding churn context and framing it as a binary classification problem.  
2. Data preparation: auditing, cleaning, imputing missing values, encoding categorical variables, scaling numerical features.  
3. Exploratory Data Analysis (EDA) to visualize churn distribution across contracts, tenure groups, billing amounts, payment methods, and internet services.  
4. Model development using Logistic Regression with class imbalance handling.  
5. Model evaluation: classification metrics, confusion matrix, ROC curve, AUC.  
6. Model interpretation: analyzing logistic coefficients to identify churn drivers.  
7. Saving the model for deployment.  

### Actions Taken in the Notebook  

- Imported standard data science libraries (`pandas`, `numpy`, `matplotlib`, `seaborn`, `sklearn`).  
- Loaded telecom churn dataset (`telecom_churn_data.csv`).  
- Converted `TotalCharges` to numeric and imputed missing values as `Tenure * MonthlyCharges`.  
- Grouped customers by tenure and monthly charges for EDA.  
- One-hot encoded categorical features; scaled numerical ones.  
- Split dataset into training and test subsets with stratification.  
- Applied Logistic Regression with `class_weight='balanced'`.  
- Evaluated using precision, recall, F1, ROC-AUC.  
- Visualized class distribution, churn proportions by groups, correlation heatmap, confusion matrix, ROC curve, and feature importance.  
- Exported the trained pipeline with `joblib`.  

### Results & Discussion (High-Level)  

- The **EDA** revealed that **contract type, tenure, and monthly charges** are key churn indicators. Customers with month-to-month contracts showed disproportionately higher churn rates compared to those on long-term contracts.  
- The **logistic model** achieved reasonable predictive performance (precision, recall, F1 reported in classification report).  
- The **ROC curve** and **AUC** indicated good discriminative ability.  
- **Feature importance** analysis highlighted financial and contractual variables as major churn drivers.  

---

## 01. Concept Overview  

This section explains the theoretical foundation of every concept and method applied in the notebook.  

### Customer Churn  
- **Definition:** Customer churn occurs when a customer terminates their relationship with a company.  
- **Impact:** Retaining customers improves profitability; losing them increases acquisition costs.  
- **Problem Framing:** A binary classification problem, predicting `Churn = Yes (1)` vs `Churn = No (0)`.  

### Logistic Regression  
- **Why Logistic Regression?**  
  Logistic Regression is simple, interpretable, and effective for binary outcomes. It models the probability that an observation belongs to class 1 (churn).  
- **Mathematical form:**  
  \n\\( P(Churn=1 | X) = \\frac{1}{1 + e^{-(w·X + b)}} \\)\n  
- **Interpretation:**  
  - Coefficients (positive → increases churn odds; negative → decreases churn odds).  
  - Easy to explain results to non-technical stakeholders.  

### Data Preparation Concepts  
- **One-Hot Encoding:** Converts categorical features into 0/1 binary vectors. Example: `Contract = {Month-to-Month, One Year, Two Year}` becomes two dummy variables.  
- **Standardization (Scaling):** Applied to numeric features (`Tenure`, `MonthlyCharges`, `TotalCharges`) to stabilize optimization.  
- **Handling Missing Values:** Imputed `TotalCharges` using domain knowledge (`Tenure * MonthlyCharges`).  
- **Stratified Split:** Ensures class proportions are preserved in both train and test sets, important for imbalanced churn datasets.  

### Class Imbalance & Weighting  
- Churn datasets typically contain far fewer “churned” customers than “retained.”  
- Logistic Regression allows setting `class_weight='balanced'`, re-scaling the importance of minority class samples.  

### Evaluation Metrics  
- Accuracy is not enough due to imbalance. Instead:  
  - **Precision:** Fraction of predicted churners that are actual churners.  
  - **Recall (Sensitivity):** Fraction of actual churners correctly identified.  
  - **F1-Score:** Balance between precision & recall.  
  - **Confusion Matrix:** Visual representation of TP, FP, FN, TN.  
  - **ROC & AUC:** Probability ranking ability across thresholds.  

### Visualization Concepts  
- **Pie Chart:** Illustrates churn vs non-churn proportions.  
- **Stacked Bar Charts:** Show churn proportions across groups (e.g., contract types, tenure brackets).  
- **Correlation Heatmap:** Captures linear associations (though categorical factorization is heuristic).  
- **Confusion Matrix Heatmap:** Performance visualization.  
- **ROC Curve:** Plots TPR vs FPR at various thresholds.  
- **Coefficient Plot (Feature Importance):** Displays strongest churn predictors.  

---

## 02. Data Overview & Preparation  

### Dataset Features  
- **Target:** `Churn` (Yes/No).  
- **Numerical Features:**  
  - `Tenure`: number of months the customer has stayed.  
  - `MonthlyCharges`: recurring bill amount.  
  - `TotalCharges`: cumulative charges (imputed if missing).  
- **Categorical Features:**  
  `Gender`, `SeniorCitizen`, `Partner`, `Dependents`, `PhoneService`, `MultipleLines`, `InternetService`, `OnlineSecurity`, `OnlineBackup`, `DeviceProtection`, `TechSupport`, `StreamingTV`, `StreamingMovies`, `Contract`, `PaperlessBilling`, `PaymentMethod`.  
- **Dropped Columns:** `CustomerID` (identifier), grouping variables (`TenureGroup`, `MonthlyChargesGroup`) used only for EDA.  

### Cleaning Process  
- `TotalCharges` converted to numeric. Non-numeric values became NaN.  
- Missing `TotalCharges` filled as `Tenure × MonthlyCharges`.  
- `SeniorCitizen` mapped from `{0,1}` to `{No,Yes}`.  
- Checked missing values and ensured none remained post-cleaning.  

### Feature Engineering  
- Grouped `Tenure` into bins: `0–12`, `13–24`, `25–48`, `49–72`.  
- Grouped `MonthlyCharges` into bins: `Low`, `Medium`, `High`, `Very High`.  
- One-hot encoded categorical variables with `drop_first=True`.  
- Scaled only numeric features using `StandardScaler`.  

---

## 03. Exploratory Data Analysis (with Plot Explanations)  

### 3.1 Distribution of Churn (Pie Chart)  
A pie chart of churn vs non-churn shows that churn is a minority class (roughly 25–30% of customers).  

**Interpretation:** Dataset is imbalanced, which justifies using class weights during training.  

![Churn Distribution](/img/posts/churn_pie.png)  

### 3.2 Churn by Contract Type (Stacked Bar Plot)  
Customers on **Month-to-Month contracts** exhibit significantly higher churn than those on one-year or two-year contracts.  

**Interpretation:** Longer contracts incentivize retention (reduced churn risk).  

![Churn by Contract Type](/img/posts/churn_contract.png)  

### 3.3 Churn by Tenure Group (Stacked Bar Plot)  
Customers with low tenure (0–12 months) show the highest churn rates.  
Customers with high tenure (>48 months) rarely churn.  

**Interpretation:** Early-stage customers are at highest risk; retention programs should focus on them.  

![Churn by Tenure Group](/img/posts/churn_tenure.png)  

### 3.4 Churn by Monthly Charges (Stacked Bar Plot)  
Churn increases as monthly charges increase.  
Customers paying very high monthly charges are more likely to leave.  

**Interpretation:** Pricing pressure plays a role in churn.  

![Churn by Monthly Charges](/img/posts/churn_monthly.png)  

### 3.5 Churn by Internet Service (Stacked Bar Plot)  
Customers with **Fiber optic** service churn at higher rates compared to DSL or no internet.  

**Interpretation:** Fiber optic customers may face higher costs or service quality issues.  

![Churn by Internet Service](/img/posts/churn_internet.png)  

### 3.6 Churn by Payment Method (Stacked Bar Plot)  
Customers using **electronic checks** churn the most.  
Credit card/automatic bank payments correlate with lower churn.  

**Interpretation:** Payment convenience and automation reduce churn likelihood.  

![Churn by Payment Method](/img/posts/churn_payment.png)  

### 3.7 Correlation Heatmap  
Heatmap shows **negative correlation** between `Tenure` and churn.  
**Positive correlation** between `MonthlyCharges`, `TotalCharges` and churn.  

**Interpretation:** Customers with higher bills but low tenure are most vulnerable.  

![Correlation Heatmap](/img/posts/churn_heatmap.png)  

---

## 04. Modeling Pipeline  

- **Train/Test Split:** 80/20, stratified on churn.  
- **Scaling:** Applied to numeric features.  
- **Model:** Logistic Regression (`max_iter=1000`, `class_weight='balanced'`).  
- **Evaluation Metrics:** classification report, confusion matrix, ROC/AUC.  
- **Interpretation:** Top-15 feature coefficients plotted.  
- **Export:** Model saved with scaler and features list.  

---

## 05. Analysing the Results  

### 5.1 Classification Report  
Reports precision, recall, F1 for both churn and non-churn.  
Typically: recall for churn is lower than precision — model catches some churners but may miss others.  

**Interpretation:** Threshold tuning could improve recall.  

### 5.2 Confusion Matrix (Heatmap)  
True Negatives (correctly predicted non-churn) dominate.  
False Negatives (missed churners) remain a key challenge.  

**Interpretation:** In business context, reducing FN is more critical than reducing FP.  

![Confusion Matrix](/img/posts/churn_confusion.png)  

### 5.3 ROC Curve and AUC  
ROC curve bows upward, indicating strong separation ability.  
AUC > 0.75 typically indicates good predictive power.  

**Interpretation:** Model is better than random guessing and can rank churn risk effectively.  

![ROC Curve](/img/posts/churn_roc.png)  

### 5.4 Feature Importance (Top 15 Logistic Coefficients)  
- **Positive coefficients (increase churn likelihood):**  
  - Month-to-Month contract  
  - Electronic check payment  
  - High monthly charges  
  - Fiber optic service  

- **Negative coefficients (decrease churn likelihood):**  
  - Long tenure  
  - Two-year contract  
  - Automatic payment methods  

**Interpretation:** Contract type, tenure, and payment method are the most powerful levers to reduce churn.  

![Top Features](/img/posts/churn_features.png)  

---

## 06. Discussion  

### Strengths of the Model  
- End-to-end reproducible pipeline.  
- Transparent and interpretable coefficients.  
- Direct identification of churn drivers for actionable strategy.  

### Limitations  
- Single split, no cross-validation.  
- Logistic Regression assumes linearity; may miss nonlinear churn patterns.  
- Correlation heatmap factorization is simplistic.  

---
